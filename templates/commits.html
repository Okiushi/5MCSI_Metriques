<html>

<head>
    <meta charset="UTF-8" />
    <title>Commits</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>

<body>
    <div id="chart_div"></div>
    <script>
        google.charts.load('current', { packages: ['corechart'] });
        google.charts.setOnLoadCallback(drawBackgroundColor);
        function drawBackgroundColor() {
            function drawChart(data) {
                // Convertir les données récupérées en un tableau utilisable par Google Charts
                var dataTable = new google.visualization.DataTable();
                // Puis on utilise les données de commitsdata avec minutes et commits
                dataTable.addColumn('number', 'Minutes');
                dataTable.addColumn('number', 'Commits');
                data.results.forEach(entry => {
                    dataTable.addRow([entry.minutes, entry.commits]);
                });
                
                // Configurer les options du graphique en ligne
                var options = {
                    title: 'Nombre de commits par minute',
                    curveType: 'function',
                    legend: { position: 'bottom' }
                };
                var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
                chart.draw(dataTable, options);
            }
            // Récupération de données depuis notre API /commitsdata/
            fetch('/commitsdata/')
                .then(response => response.json())
                .then(data => {
                    drawChart(data);
                })
        }
    </script>
</body>

</html>